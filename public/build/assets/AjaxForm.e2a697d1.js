import{p as c,a as b}from"./fetch.a4f05ce1.js";import{o as a,d as o,e as n,f as g,n as S,h as v,b as d,t as f,i as y,j as h,u as m}from"./app.e848e04b.js";import{_ as E}from"./plugin-vue_export-helper.f2aa9cb4.js";const _={props:{action:{type:String,default:""},button:{type:Boolean,default:!0},buttonSend:{type:String,default:""},buttonSending:{type:String,default:""},buttonSent:{type:String,default:""},buttonReset:{type:String,default:""},sendIcon:{type:String,default:"paper-plane"},autoReset:{type:Boolean,default:!1}},data:()=>({fieldErrors:[],sending:!1,sent:!1}),computed:{formData(){return new URLSearchParams(new FormData(this.$el)).toString()}},watch:{sending(){this.$emit("change",this.sending)}},provide(){return{fieldError:this.fieldError,validate:this.validate,validateForm:this.validateForm}},methods:{fieldError(e){return this.fieldErrors[e]?this.fieldErrors[e][0]:null},precog(e,s){return c(e,s).then(()=>{this.fieldErrors=Object.keys(this.fieldErrors).filter(t=>s[t]).reduce((t,i)=>Object.assign(t,{[i]:this.fieldErrors[i]}),{})}).catch(t=>{t&&t.errors&&(this.fieldErrors=Object.assign(this.fieldErrors,t.errors))})},call(e,s){if(!this.sending&&!this.sent)return this.sending=!0,b(e,s.data).then(t=>{this.fieldErrors={},this.sending=!1,this.autoReset||(this.sent=!0),(s.success||s.then||function(){})(t),(s.complete||s.finally||function(){})(),this.$emit("success",t),this.autoReset&&this.onReset()}).catch(t=>{t&&t.errors&&(this.fieldErrors=t.errors),this.sending=!1;var i;(i=s.error||s.catch)&&i(t);var l;(l=s.complete||s.finally)&&l(),!i&&!l&&this.fieldErrors.length>0&&this.$dialog.alert(this.$t("form.internalError")),this.$emit("error")})},onSubmit(){this.submit()},onReset(){this.$emit("reset"),this.fieldErrors={},this.sending=!1,this.sent=!1},validate(e,s){return this.precog(this.action,{[e]:s})},validateForm(e){return this.precog(this.action,e||this.formData)},submit(e,s){this.$emit("beforeSubmit"),e=e||this.formData;var t=this.call(this.action,Object.assign({data:e},s));return this.$emit("afterSubmit"),t}}},p=["action"],R=["disabled"],k={key:0},j=["disabled"],F={key:0},w=n("span",{class:"fas fa-check-circle"},null,-1),B={key:1},O=n("span",{class:"fas fa-spinner"},null,-1),A={key:2},C={key:0,type:"reset",class:"btn btn-primary btn-lg"},D=n("span",{class:"fas fa-backward"},null,-1);function N(e,s,t,i,l,r){return a(),o("form",{action:t.action,method:"post",autocomplete:"off",onSubmit:s[0]||(s[0]=m((...u)=>r.onSubmit&&r.onSubmit(...u),["prevent"])),onReset:s[1]||(s[1]=m((...u)=>r.onReset&&r.onReset(...u),["prevent"]))},[n("fieldset",{disabled:e.sending||e.sent},[g(e.$slots,"default",S(v({sending:e.sending,sent:e.sent,submit:r.submit,onSubmit:r.onSubmit,onReset:r.onReset,fieldError:r.fieldError,validate:r.validate,validateForm:r.validateForm})))],8,R),t.button?(a(),o("fieldset",k,[n("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:e.sent||e.sending},[e.sent?(a(),o("span",F,[w,d(" "+f(t.buttonSent||e.$t("common.form.sent")),1)])):e.sending?(a(),o("span",B,[O,d(" "+f(t.buttonSending||e.$t("common.form.sending")),1)])):(a(),o("span",A,[n("span",{class:y("fas fa-"+t.sendIcon)},null,2),d(" "+f(t.buttonSend||e.$t("common.form.send")),1)]))],8,j),e.sent?(a(),o("button",C,[n("span",null,[D,d(" "+f(t.buttonReset||e.$t("common.form.reset")),1)])])):h("v-if",!0)])):h("v-if",!0)],40,p)}var I=E(_,[["render",N],["__file","/home/korko/secretsanta.dev/resources/js/Components/AjaxForm.vue"]]);export{I as A};
