import{f as c}from"./fetch.01f53e84.js";import{o as a,d as r,e as i,f as b,n as g,h as S,b as d,t as f,i as y,j as h,M as m}from"./app.6256a668.js";import{_ as v}from"./Layout.7e513d1b.js";const R={props:{action:{type:String,default:""},button:{type:Boolean,default:!0},buttonSend:{type:String,default:""},buttonSending:{type:String,default:""},buttonSent:{type:String,default:""},buttonReset:{type:String,default:""},v$:{type:Object,default:null},sendIcon:{type:String,default:"paper-plane"},autoReset:{type:Boolean,default:!1}},data:()=>({fieldErrors:[],sending:!1,sent:!1}),watch:{sending(){this.$emit("change",this.sending)}},methods:{fieldError(e){return this.fieldErrors[e]?this.fieldErrors[e][0]:null},call(e,s){if(!this.sending&&!this.sent)return this.v$&&this.v$.$touch(),this.v$&&this.v$.$invalid?!1:(this.sending=!0,c(e,"POST",s.data).then(t=>{this.fieldErrors=[],this.sending=!1,this.autoReset||(this.sent=!0),(s.success||s.then||function(){})(t),(s.complete||s.finally||function(){})(),this.$emit("success",t),this.autoReset&&this.onReset()}).catch(t=>{t&&t.errors&&(this.fieldErrors=t.errors),this.sending=!1;var l;(l=s.error||s.catch)&&l(t);var o;(o=s.complete||s.finally)&&o(),!l&&!o&&this.fieldErrors.length>0&&this.$dialog.alert(this.$t("form.internalError")),this.$emit("error")}))},onSubmit(){this.submit()},onReset(){this.$emit("reset"),this.fieldErrors=[],this.v$.$reset(),this.sending=!1,this.sent=!1},submit(e,s){this.$emit("beforeSubmit"),e=e||serialize(this.$el);var t=this.call(this.action,Object.assign({data:e},s));return this.$emit("afterSubmit"),t}}},_=["action"],E=["disabled"],$={key:0},k=["disabled"],p={key:0},j=i("span",{class:"fas fa-check-circle"},null,-1),B={key:1},w=i("span",{class:"fas fa-spinner"},null,-1),z={key:2},N={key:0,type:"reset",class:"btn btn-primary btn-lg"},O=i("span",{class:"fas fa-backward"},null,-1);function P(e,s,t,l,o,n){return a(),r("form",{action:t.action,method:"post",autocomplete:"off",onSubmit:s[0]||(s[0]=m((...u)=>n.onSubmit&&n.onSubmit(...u),["prevent"])),onReset:s[1]||(s[1]=m((...u)=>n.onReset&&n.onReset(...u),["prevent"]))},[i("fieldset",{disabled:e.sending||e.sent},[b(e.$slots,"default",g(S({sending:e.sending,sent:e.sent,submit:n.submit,onSubmit:n.onSubmit,onReset:n.onReset,fieldError:n.fieldError})))],8,E),t.button?(a(),r("fieldset",$,[i("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:e.sent||e.sending},[e.sent?(a(),r("span",p,[j,d(" "+f(t.buttonSent||e.$t("common.form.sent")),1)])):e.sending?(a(),r("span",B,[w,d(" "+f(t.buttonSending||e.$t("common.form.sending")),1)])):(a(),r("span",z,[i("span",{class:y("fas fa-"+t.sendIcon)},null,2),d(" "+f(t.buttonSend||e.$t("common.form.send")),1)]))],8,k),e.sent?(a(),r("button",N,[i("span",null,[O,d(" "+f(t.buttonReset||e.$t("common.form.reset")),1)])])):h("",!0)])):h("",!0)],40,_)}var I=v(R,[["render",P]]);export{I as A};
